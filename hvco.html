<!doctype html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <title>5-Minute KPI Clarity Template | TechPro IT Solutions</title>
  <meta name="description" content="A short clarity experience to help you track the 5 numbers that matter most‚Äîin 5 minutes a week. Built for business owners." />

  <!-- Decide your canonical URL style and stick to it -->
  <link rel="canonical" href="https://techproit.solutions/hvco" />
  <meta property="og:title" content="5-Minute KPI Clarity Template" />
  <meta property="og:description" content="Know exactly how your business is performing‚Äîin just 5 minutes a week." />
  <meta property="og:url" content="https://techproit.solutions/hvco" />
  <meta property="og:type" content="website" />

  <!-- Your CSS modules (adjust paths to match your deployment) -->
  <link rel="stylesheet" href="/base.css" />
  <link rel="stylesheet" href="/navigation.css" />
  <link rel="stylesheet" href="/components.css" />
  <link rel="stylesheet" href="/hero_animations.css" />
  <link rel="stylesheet" href="/ancillary.css" />

  <!-- HVCO-specific CSS (namespaced to avoid collisions) -->
  <style>
    .hvco-shell {
      width: 100%;
      max-width: 1100px;
      margin: 0 auto;
    }

    /* Make hero usable for a form page */
    .hvco-hero {
      min-height: 100vh; /* matches your hero intent */
      display: flex;
      align-items: center;
      justify-content: center;
      padding-top: 7.5rem; /* space for fixed nav */
      padding-bottom: 4rem;
    }

    /* Glass card wrapper that matches your glass language */
    .hvco-card {
      background: var(--glass);
      border: 1px solid var(--glass-border);
      border-radius: 24px;
      backdrop-filter: blur(14px);
      box-shadow: var(--shadow-lg);
      overflow: hidden;
    }

    .hvco-grid {
      display: grid;
      grid-template-columns: 1.05fr 0.95fr;
      gap: 1.5rem;
      align-items: start;
    }

    @media (max-width: 900px) {
      .hvco-grid { grid-template-columns: 1fr; }
    }

    .hvco-pane {
      padding: 2rem;
    }

    .hvco-kicker {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.5rem 0.9rem;
      border-radius: 999px;
      background: rgba(255,255,255,0.12);
      border: 1px solid rgba(255,255,255,0.16);
      font-weight: 600;
      font-size: 0.9rem;
      margin-bottom: 1rem;
    }

    .hvco-lede {
      font-size: 1.1rem;
      opacity: 0.95;
      max-width: 54ch;
      margin: 0 auto;
    }

    .hvco-list {
      margin-top: 1.5rem;
      display: grid;
      gap: 0.9rem;
    }

    .hvco-list-item {
      display: flex;
      gap: 0.9rem;
      align-items: flex-start;
      padding: 1rem 1rem;
      border-radius: 18px;
      background: rgba(255,255,255,0.08);
      border: 1px solid rgba(255,255,255,0.12);
    }

    .hvco-badge {
      width: 34px;
      height: 34px;
      border-radius: 12px;
      display: grid;
      place-items: center;
      background: rgba(255,255,255,0.18);
      border: 1px solid rgba(255,255,255,0.22);
      flex: 0 0 auto;
      font-weight: 800;
    }

    .hvco-form {
      display: grid;
      gap: 1rem;
    }

    .hvco-form label {
      font-weight: 600;
      display: block;
      margin-bottom: 0.4rem;
      color: white;
    }

    .hvco-input {
      width: 100%;
      min-height: 44px;
      padding: 0.9rem 1.1rem;
      border-radius: 16px;
      border: 2px solid rgba(255,255,255,0.18);
      background: rgba(255,255,255,0.08);
      color: white;
      font: inherit;
      transition: all 0.2s ease;
    }
    .hvco-input:focus {
      outline: none;
      border-color: rgba(255,255,255,0.45);
      box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.25);
    }

    .hvco-help {
      font-size: 0.9rem;
      opacity: 0.9;
      margin-top: 0.4rem;
    }

    .hvco-options {
      display: grid;
      gap: 0.75rem;
      margin-top: 0.75rem;
    }

    .hvco-opt {
      display: flex;
      gap: 0.8rem;
      align-items: flex-start;
      padding: 1rem;
      border-radius: 18px;
      background: rgba(255,255,255,0.08);
      border: 1px solid rgba(255,255,255,0.14);
      cursor: pointer;
      transition: all 0.2s ease;
    }
    .hvco-opt:hover { transform: translateY(-2px); background: rgba(255,255,255,0.12); }
    .hvco-opt input { margin-top: 0.25rem; }

    .hvco-opt strong { display:block; color: white; }
    .hvco-opt span { display:block; color: rgba(255,255,255,0.86); }

    .hvco-nav {
      display: flex;
      gap: 0.75rem;
      flex-wrap: wrap;
      margin-top: 1.25rem;
      justify-content: center;
    }

    .hvco-progress {
      height: 10px;
      border-radius: 999px;
      background: rgba(255,255,255,0.16);
      border: 1px solid rgba(255,255,255,0.18);
      overflow: hidden;
      margin: 1.25rem 0 0.75rem;
    }

    .hvco-progress > div {
      height: 100%;
      width: 0%;
      background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(255,255,255,0.55));
      transition: width 0.25s ease;
    }

    .hvco-meta {
      display: flex;
      justify-content: space-between;
      gap: 1rem;
      font-size: 0.9rem;
      opacity: 0.92;
    }

    .hvco-note {
      margin-top: 0.75rem;
      padding: 0.9rem 1rem;
      border-radius: 16px;
      background: rgba(245, 158, 11, 0.16);
      border: 1px solid rgba(245, 158, 11, 0.25);
      display: none;
    }

    /* Delivery section */
    .hvco-delivery {
      display: none;
      padding-top: 7.5rem; /* space for nav */
      padding-bottom: 5rem;
      background: var(--gradient-primary);
      min-height: 100vh;
    }

    .hvco-delivery .success-hero {
      min-height: unset; /* let our section control height */
      background: transparent; /* already on gradient */
      padding-top: 0;
    }

    .hvco-video {
      width: 100%;
      border-radius: 20px;
      overflow: hidden;
      border: 1px solid rgba(255,255,255,0.18);
      background: rgba(0,0,0,0.35);
    }
    .hvco-video video {
      width: 100%;
      display: block;
      cursor: pointer;
    }
  </style>
</head>

<body>
  <!-- Optional theme toggle (matches your navigation module) -->
  <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
    <span class="theme-icon">üåì</span>
    <span>Theme</span>
  </button>

  <!-- Floating navigation (matches your navigation module) -->
  <div class="nav-container" id="navContainer">
    <nav aria-label="Primary">
      <a href="/index.html">Home</a>
      <a href="/financial-operations.html">Financial Ops</a>
      <a href="/business-intelligence.html">Business Intelligence</a>
      <a href="/technology-services.html">Technology Services</a>
      <a href="/about.html">About</a>
      <a href="/contact.html">Contact</a>
    </nav>
  </div>

  <!-- Mobile nav (optional if you use it site-wide) -->
  <div class="mobile-nav">
    <button class="hamburger" id="hamburger" aria-label="Open menu">‚ò∞</button>
  </div>
  <div class="drawer" id="drawer" aria-hidden="true">
    <button class="close-drawer" id="closeDrawer" aria-label="Close menu">√ó</button>
    <nav aria-label="Mobile">
      <a href="/index.html">Home</a>
      <a href="/financial-operations.html">Financial Ops</a>
      <a href="/business-intelligence.html">Business Intelligence</a>
      <a href="/technology-services.html">Technology Services</a>
      <a href="/about.html">About</a>
      <a href="/contact.html">Contact</a>
    </nav>
  </div>

  <!-- MAIN: HVCO hero + wizard -->
  <section class="hero hvco-hero" id="hvcoStart">
    <div class="floating-elements" aria-hidden="true">
      <div class="floating-element">‚óª</div>
      <div class="floating-element">‚ñ≥</div>
      <div class="floating-element">‚óã</div>
    </div>

    <div class="hero-content hvco-shell">
      <div class="hvco-kicker">üß† 5-Minute KPI Clarity Template</div>

      <h1>Know EXACTLY How Your Business Is Performing ‚Äî In Just 5 Minutes a Week</h1>

      <p class="hvco-lede">
        A short clarity experience built for business owners who want visibility without spreadsheets, math headaches, or generic ‚Äúbest practices.‚Äù
      </p>

      <div style="height: 1.75rem;"></div>

      <div class="hvco-grid">
        <!-- Left: what they get -->
        <div class="hvco-card">
          <div class="hvco-pane">
            <div class="hvco-list">
              <div class="hvco-list-item">
                <div class="hvco-badge">‚úì</div>
                <div>
                  <strong>Built for business owners</strong>
                  <div style="opacity:.9">Plain language, practical structure, and zero accounting ego.</div>
                </div>
              </div>
              <div class="hvco-list-item">
                <div class="hvco-badge">‚úì</div>
                <div>
                  <strong>Clarity before urgency</strong>
                  <div style="opacity:.9">See pressure early enough that your options are still good.</div>
                </div>
              </div>
              <div class="hvco-list-item">
                <div class="hvco-badge">‚úì</div>
                <div>
                  <strong>Customizable KPIs</strong>
                  <div style="opacity:.9">Start with a proven baseline, then tailor to your model.</div>
                </div>
              </div>
            </div>

            <div class="hvco-progress" aria-label="Progress">
              <div id="hvcoBar"></div>
            </div>
            <div class="hvco-meta">
              <span id="hvcoStepLabel">Step 1 of 7</span>
              <span>Most people finish in ~3 minutes</span>
            </div>
          </div>
        </div>

        <!-- Right: wizard -->
        <div class="hvco-card">
          <div class="hvco-pane">
            <form id="hvcoForm" class="hvco-form" method="post" action="FORM_ENDPOINT">
              <!-- Hidden tracking -->
              <input type="hidden" name="intent" id="intent" value="" />
              <input type="hidden" name="utm_source" id="utm_source" value="" />
              <input type="hidden" name="utm_medium" id="utm_medium" value="" />
              <input type="hidden" name="utm_campaign" id="utm_campaign" value="" />
              <input type="hidden" name="utm_content" id="utm_content" value="" />
              <input type="hidden" name="utm_term" id="utm_term" value="" />

              <!-- STEP 1: Contact -->
              <div class="hvco-step" data-step="1">
                <div>
                  <label for="name">Name</label>
                  <input class="hvco-input" id="name" name="name" type="text" autocomplete="name" required />
                </div>

                <div>
                  <label for="email">Email</label>
                  <input class="hvco-input" id="email" name="email" type="email" autocomplete="email" required />
                  <div class="hvco-help">We‚Äôll send your template + walkthrough here.</div>
                </div>

                <div>
                  <label for="mobile">Mobile (optional)</label>
                  <input class="hvco-input" id="mobile" name="mobile" type="tel" autocomplete="tel" placeholder="(555) 555-5555" />
                  <div class="hvco-help">Optional‚Äîonly if you want a quick reminder.</div>
                </div>
              </div>

              <!-- STEP 2 -->
              <div class="hvco-step" data-step="2" style="display:none;">
                <label>When it comes to your business numbers, which best describes you right now?</label>
                <div class="hvco-options">
                  <label class="hvco-opt"><input type="radio" name="q_visibility" value="high" required />
                    <div><strong>I understand them well</strong><span>I use numbers to make decisions regularly.</span></div>
                  </label>
                  <label class="hvco-opt"><input type="radio" name="q_visibility" value="medium" />
                    <div><strong>I look at them, but‚Ä¶</strong><span>They don‚Äôt clearly tell me what to do next.</span></div>
                  </label>
                  <label class="hvco-opt"><input type="radio" name="q_visibility" value="delegated" />
                    <div><strong>I rely on others</strong><span>I get reports but don‚Äôt feel confident acting on them.</span></div>
                  </label>
                  <label class="hvco-opt"><input type="radio" name="q_visibility" value="avoid" />
                    <div><strong>I avoid them</strong><span>It feels overwhelming or unclear.</span></div>
                  </label>
                </div>
              </div>

              <!-- STEP 3 -->
              <div class="hvco-step" data-step="3" style="display:none;">
                <label>Which statement feels closest to what you‚Äôre hoping for right now?</label>
                <div class="hvco-options">
                  <label class="hvco-opt"><input type="radio" name="q_hope" value="reassurance" required />
                    <div><strong>Reassurance</strong><span>I mainly want confirmation that I‚Äôm ‚Äúokay.‚Äù</span></div>
                  </label>
                  <label class="hvco-opt"><input type="radio" name="q_hope" value="understand" />
                    <div><strong>Understanding</strong><span>I want to know what‚Äôs actually driving results.</span></div>
                  </label>
                  <label class="hvco-opt"><input type="radio" name="q_hope" value="take_off_plate" />
                    <div><strong>Delegation</strong><span>I want someone to take this off my plate completely.</span></div>
                  </label>
                  <label class="hvco-opt"><input type="radio" name="q_hope" value="decide_better" />
                    <div><strong>Clarity ‚Üí decisions</strong><span>I want insight so I can decide with confidence.</span></div>
                  </label>
                </div>

                <div class="hvco-note" id="noteBandAid">
                  Heads up: this clarity experience is built for owners who want visibility and are willing to use it.
                  If you‚Äôre mainly looking for reassurance or a quick handoff, this may feel different‚Äîin a good way.
                </div>
              </div>

              <!-- STEP 4 -->
              <div class="hvco-step" data-step="4" style="display:none;">
                <label>How does decision-making feel in your business lately?</label>
                <div class="hvco-options">
                  <label class="hvco-opt"><input type="radio" name="q_pressure" value="calm" required />
                    <div><strong>Calm & intentional</strong><span>Mostly steady; I want sharper visibility.</span></div>
                  </label>
                  <label class="hvco-opt"><input type="radio" name="q_pressure" value="uncertain" />
                    <div><strong>Uncertain but manageable</strong><span>Some decisions feel like guesses.</span></div>
                  </label>
                  <label class="hvco-opt"><input type="radio" name="q_pressure" value="reactive" />
                    <div><strong>Increasingly reactive</strong><span>Too many surprises; I‚Äôm adjusting constantly.</span></div>
                  </label>
                  <label class="hvco-opt"><input type="radio" name="q_pressure" value="urgent" />
                    <div><strong>Urgent</strong><span>I feel behind the curve and need clarity fast.</span></div>
                  </label>
                </div>
              </div>

              <!-- STEP 5 -->
              <div class="hvco-step" data-step="5" style="display:none;">
                <label>How do you want support to show up?</label>
                <div class="hvco-options">
                  <label class="hvco-opt"><input type="radio" name="q_support" value="tools" required />
                    <div><strong>Tools + understanding</strong><span>Help me understand this so I can lead better.</span></div>
                  </label>
                  <label class="hvco-opt"><input type="radio" name="q_support" value="alongside_team" />
                    <div><strong>Guidance with my team</strong><span>Insight alongside what my bookkeeper/CPA does.</span></div>
                  </label>
                  <label class="hvco-opt"><input type="radio" name="q_support" value="tell_me_exactly" />
                    <div><strong>Tell me exactly what to do</strong><span>I want direction, step-by-step.</span></div>
                  </label>
                  <label class="hvco-opt"><input type="radio" name="q_support" value="not_sure" />
                    <div><strong>Not sure</strong><span>I just know this isn‚Äôt working.</span></div>
                  </label>
                </div>
              </div>

              <!-- STEP 6 -->
              <div class="hvco-step" data-step="6" style="display:none;">
                <label>Which statement do you agree with most?</label>
                <div class="hvco-options">
                  <label class="hvco-opt"><input type="radio" name="q_belief" value="clarity_better_decisions" required />
                    <div><strong>Clarity leads to better decisions</strong><span>I want the truth early, not late.</span></div>
                  </label>
                  <label class="hvco-opt"><input type="radio" name="q_belief" value="work_harder" />
                    <div><strong>Growth is mostly working harder</strong><span>I just need to push more.</span></div>
                  </label>
                  <label class="hvco-opt"><input type="radio" name="q_belief" value="numbers_not_my_job" />
                    <div><strong>Numbers aren‚Äôt my responsibility</strong><span>I‚Äôd rather not engage with them.</span></div>
                  </label>
                  <label class="hvco-opt"><input type="radio" name="q_belief" value="open_to_uncomfortable" />
                    <div><strong>I‚Äôm open to uncomfortable clarity</strong><span>I‚Äôd rather know than guess.</span></div>
                  </label>
                </div>
              </div>

              <!-- STEP 7 -->
              <div class="hvco-step" data-step="7" style="display:none;">
                <label>Before we send your template, which feels true for you right now?</label>
                <div class="hvco-options">
                  <label class="hvco-opt"><input type="radio" name="q_ready" value="ready" required />
                    <div><strong>I‚Äôm ready for clarity + next steps</strong><span>Even if it challenges assumptions.</span></div>
                  </label>
                  <label class="hvco-opt"><input type="radio" name="q_ready" value="curious" />
                    <div><strong>I‚Äôm curious</strong><span>I want clarity, but I‚Äôm still exploring.</span></div>
                  </label>
                  <label class="hvco-opt"><input type="radio" name="q_ready" value="reassurance" />
                    <div><strong>I mainly want reassurance</strong><span>I‚Äôm not ready to change much.</span></div>
                  </label>
                  <label class="hvco-opt"><input type="radio" name="q_ready" value="just_browsing" />
                    <div><strong>I‚Äôm just browsing</strong><span>No pressure‚Äîsend it anyway.</span></div>
                  </label>
                </div>
                <div class="hvco-help">Either way, you‚Äôll still receive the tool.</div>
              </div>

              <div class="hvco-nav">
                <button type="button" class="btn btn-secondary" id="backBtn">Back</button>
                <button type="button" class="btn btn-primary" id="nextBtn">Next</button>
                <button type="submit" class="btn btn-primary" id="submitBtn" style="display:none;">Send my template</button>
              </div>

              <p style="margin-top: 1rem; opacity: 0.9; font-size: 0.9rem;">
                By submitting, you agree to receive the template + related guidance. Unsubscribe anytime.
              </p>
            </form>
          </div>
        </div>
      </div>

      <div style="height: 2rem;"></div>

      <div class="cta-buttons" style="justify-content:center;">
        <a class="btn btn-secondary" href="/index.html">Return to site</a>
      </div>
    </div>
  </section>

  <!-- DELIVERY / THANK YOU -->
  <section class="hvco-delivery" id="delivery">
    <div class="container success-hero">
      <div class="success-content" style="text-align:center; padding: 2rem;">
        <div class="success-icon" aria-hidden="true">
          <!-- simple inline icon -->
          <svg width="64" height="64" viewBox="0 0 24 24" fill="none">
            <path d="M20 6L9 17l-5-5" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <h1>You‚Äôre in ‚úÖ</h1>
        <h2>Check your inbox in a minute.</h2>
        <p style="max-width: 60ch; margin: 0 auto; opacity: .92;">
          Your KPI Clarity Template + walkthrough is on the way. In the meantime, here‚Äôs everything in one place.
        </p>

        <div style="height: 2.25rem;"></div>

        <div class="services-grid" style="max-width: 1000px; margin: 0 auto;">
          <div class="service-card" style="cursor:default;">
            <div class="service-card-content">
              <div class="service-card-main">
                <h3>1) Copy the KPI Template</h3>
                <p>Make a copy of the live Google Sheet (pre-filled formulas). Customize it to your business.</p>
              </div>
              <div class="cta-buttons">
                <a class="btn btn-primary" id="sheetLink" href="GOOGLE_SHEET_COPY_URL" target="_blank" rel="noopener">Copy the Sheet</a>
              </div>
            </div>
          </div>

          <div class="service-card" style="cursor:default;">
            <div class="service-card-content">
              <div class="service-card-main">
                <h3>2) Watch the Walkthrough</h3>
                <p>5‚Äì7 minutes. How to use the template and what each KPI actually tells you.</p>
              </div>
              <div class="cta-buttons">
                <a class="btn btn-primary" id="videoLink" href="WALKTHROUGH_VIDEO_URL" target="_blank" rel="noopener">Watch the Video</a>
              </div>
            </div>
          </div>
        </div>

        <div style="height: 2.5rem;"></div>

        <!-- Passive VLP layer -->
        <div class="hvco-card" style="max-width: 1000px; margin: 0 auto;">
          <div class="hvco-pane">
            <h3 style="margin-bottom: .5rem;">Optional: Want to understand how I approach this work?</h3>
            <p style="opacity: .92; margin-bottom: 1rem;">
              Not required. If it‚Äôs helpful, watch how I think about clarity, responsibility, and what support should feel like.
              <br /><strong>Click the video to restart from the beginning with sound.</strong>
            </p>

            <div class="hvco-video">
              <video id="vlpVideo" autoplay muted playsinline preload="metadata">
                <source src="VLP_VIDEO_URL" type="video/mp4" />
                Your browser does not support the video tag.
              </video>
            </div>

            <div style="height: 1.25rem;"></div>

            <div class="cta-buttons">
              <a class="btn btn-primary" id="bookLink" href="BOOKING_URL" target="_blank" rel="noopener">Book a KPI Clarity Call</a>
              <a class="btn btn-secondary" href="/index.html">Return to site</a>
            </div>

            <p style="margin-top: 1rem; opacity: .9;">
              Not ready to talk? Use the tool. Clarity comes first.
            </p>
          </div>
        </div>

        <div class="helpful-links">
          <h3>Quick Links</h3>
          <div class="quick-links">
            <a class="quick-link" href="/cash-flow-mastery.html">Cash Flow Mastery</a>
            <a class="quick-link" href="/portfolio-clarity.html">Portfolio Clarity</a>
            <a class="quick-link" href="/contact.html">Contact</a>
          </div>
        </div>

      </div>
    </div>
  </section>

  <script>
    // ---------------------------
    // Theme toggle (simple)
    // ---------------------------
    const themeToggle = document.getElementById("themeToggle");
    const root = document.documentElement;

    // Load saved theme if present
    const savedTheme = localStorage.getItem("theme");
    if (savedTheme) root.setAttribute("data-theme", savedTheme);

    themeToggle?.addEventListener("click", () => {
      const current = root.getAttribute("data-theme") || "dark";
      const next = current === "dark" ? "light" : "dark";
      root.setAttribute("data-theme", next);
      localStorage.setItem("theme", next);
    });

    // ---------------------------
    // Mobile drawer
    // ---------------------------
    const hamburger = document.getElementById("hamburger");
    const drawer = document.getElementById("drawer");
    const closeDrawer = document.getElementById("closeDrawer");

    function openDrawer(){
      drawer.classList.add("open");
      drawer.setAttribute("aria-hidden", "false");
    }
    function closeDrawerFn(){
      drawer.classList.remove("open");
      drawer.setAttribute("aria-hidden", "true");
    }
    hamburger?.addEventListener("click", openDrawer);
    closeDrawer?.addEventListener("click", closeDrawerFn);
    drawer?.addEventListener("click", (e) => {
      if (e.target === drawer) closeDrawerFn();
    });

    // ---------------------------
    // Pull intent + UTMs into hidden fields
    // ---------------------------
    const qs = new URLSearchParams(window.location.search);
    const setIf = (id, key) => {
      const el = document.getElementById(id);
      if (!el) return;
      const v = qs.get(key);
      if (v) el.value = v;
    };
    setIf("intent", "intent");
    ["utm_source","utm_medium","utm_campaign","utm_content","utm_term"].forEach(k => setIf(k, k));

    // ---------------------------
    // Wizard
    // ---------------------------
    const form = document.getElementById("hvcoForm");
    const steps = Array.from(document.querySelectorAll(".hvco-step"));
    const bar = document.getElementById("hvcoBar");
    const label = document.getElementById("hvcoStepLabel");
    const backBtn = document.getElementById("backBtn");
    const nextBtn = document.getElementById("nextBtn");
    const submitBtn = document.getElementById("submitBtn");
    const noteBandAid = document.getElementById("noteBandAid");

    let currentStep = 1;
    const totalSteps = steps.length;

    function showStep(n){
      currentStep = n;
      steps.forEach(s => s.style.display = "none");
      const active = steps.find(s => Number(s.dataset.step) === n);
      if (active) active.style.display = "grid";

      const pct = Math.round(((n - 1) / (totalSteps - 1)) * 100);
      bar.style.width = pct + "%";
      label.textContent = `Step ${n} of ${totalSteps}`;

      backBtn.style.display = (n === 1) ? "none" : "inline-flex";
      nextBtn.style.display = (n === totalSteps) ? "none" : "inline-flex";
      submitBtn.style.display = (n === totalSteps) ? "inline-flex" : "none";

      // Negation note logic on step 3
      if (n === 3){
        const val = form?.q_hope?.value || "";
        noteBandAid.style.display = (val === "reassurance" || val === "take_off_plate") ? "block" : "none";
      } else {
        if (noteBandAid) noteBandAid.style.display = "none";
      }
    }

    function stepValid(n){
      const step = steps.find(s => Number(s.dataset.step) === n);
      if (!step) return true;
      const required = step.querySelectorAll("[required]");
      for (const el of required){
        if (el.type === "radio"){
          const checked = form.querySelector(`input[name="${el.name}"]:checked`);
          if (!checked) return false;
        } else {
          if (!el.value || !el.value.trim()) return false;
        }
      }
      return true;
    }

    backBtn?.addEventListener("click", () => showStep(Math.max(1, currentStep - 1)));

    nextBtn?.addEventListener("click", () => {
      if (!stepValid(currentStep)) return;
      showStep(Math.min(totalSteps, currentStep + 1));
    });

    form?.addEventListener("change", (e) => {
      if (currentStep === 3 && e.target?.name === "q_hope"){
        const val = form.q_hope.value;
        noteBandAid.style.display = (val === "reassurance" || val === "take_off_plate") ? "block" : "none";
      }
    });

    // ---------------------------
    // Submit behavior
    // - If you keep FORM_ENDPOINT, you can let it submit normally.
    // - Or intercept and POST via fetch.
    // ---------------------------
    form?.addEventListener("submit", async (e) => {
      e.preventDefault();

      // TODO: If you want to POST with fetch:
      // const endpoint = form.getAttribute("action");
      // await fetch(endpoint, { method: "POST", body: new FormData(form) });

      // Show delivery section
      document.getElementById("hvcoStart").style.display = "none";
      document.getElementById("delivery").style.display = "block";
      window.scrollTo({ top: 0, behavior: "smooth" });

      // Optional: weight CTA based on profile
      applyProfile(computeProfile());
    });

    const hubspotPayload = {
      firstname: formData.name,
      email: formData.email,
      phone: formData.mobile || "",
      hvco_intent: intentValue,          // from ?intent=cashflow
      hvco_profile: computedProfile,     // A / B / C
      hvco_visibility_level: visibility,
      hvco_primary_hope: hope,
      hvco_decision_pressure: pressure,
      hvco_support_preference: support,
      hvco_numbers_belief: belief,
      hvco_readiness: readiness
    };
    
    function computeProfile(){
      const hope = form?.q_hope?.value || "";
      const belief = form?.q_belief?.value || "";
      const ready = form?.q_ready?.value || "";
      const pressure = form?.q_pressure?.value || "";

      let score = 0;
      if (hope === "decide_better" || hope === "understand") score += 2;
      if (belief === "clarity_better_decisions" || belief === "open_to_uncomfortable") score += 2;
      if (ready === "ready") score += 2;
      if (pressure === "urgent" || pressure === "reactive") score += 1;

      if (hope === "reassurance" || hope === "take_off_plate") score -= 2;
      if (belief === "numbers_not_my_job") score -= 2;

      if (score >= 4) return "A";
      if (score >= 1) return "B";
      return "C";
    }

    function applyProfile(profile){
      const bookLink = document.getElementById("bookLink");
      if (!bookLink) return;

      if (profile === "A") {
        bookLink.textContent = "Book a KPI Clarity Call";
        bookLink.style.opacity = "1";
      } else if (profile === "B") {
        bookLink.textContent = "Optional: Talk through your numbers";
        bookLink.style.opacity = "0.95";
      } else {
        bookLink.textContent = "Optional: Talk when you‚Äôre ready";
        bookLink.style.opacity = "0.85";
      }
    }

    // VLP: autoplay muted; click restarts w/ sound + controls
    const vlp = document.getElementById("vlpVideo");
    vlp?.addEventListener("click", () => {
      try {
        vlp.pause();
        vlp.currentTime = 0;
        vlp.muted = false;
        vlp.controls = true;
        vlp.play();
      } catch {}
    });

    // init
    showStep(1);

    function submitToHubSpot(payload) {
      const hsForm = document.querySelector("#hs-form-container form");
      if (!hsForm) {
        console.error("HubSpot form not ready");
        return;
      }
    
      Object.keys(payload).forEach(key => {
        const input = hsForm.querySelector(`[name="${key}"]`);
        if (input) input.value = payload[key];
      });
    
      hsForm.submit();
    }

  </script>
  
  <!-- Hidden HubSpot Form -->
  <div id="hs-form-container" style="display:none;"></div>
  <script charset="utf-8" type="text/javascript" src="//js-na2.hsforms.net/forms/embed/v2.js"></script>
  <script>
    hbspt.forms.create({
      portalId: "243989823",
      formId: "48d12b11-a94b-4adc-896a-c15d974311d0",
      region: "na2"
      target: "#hs-form-container"
    });
  </script>
</body>
</html>
